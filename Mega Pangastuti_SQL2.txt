Ini adalah hasil pengerjaan HW SQL part 2

--soal 1
select nama, email, bulan_lahir, tanggal_registrasi
from rakamin_customer
where (email like '%yahoo%' or lower(email) like '%roketmail%') 
	and (tanggal_registrasi >= '2012-01-01' and tanggal_registrasi <= '2012-03-31' )
	and lower(bulan_lahir) in ('januari', 'februari', 'maret')


--soal 2
select id_order, id_pelanggan, harga, (harga*ppn)+harga as harga_ppn,
	case when (harga*ppn)+harga <= 20000 then 'LOW'
		 when (harga*ppn)+harga <= 50000 then 'MEDIUM'
		 when (harga*ppn)+harga > 50000 then 'HIGH'
	end as spending_bucket
from rakamin_order
order by harga_ppn desc

--soal 3
select id_merchant, count(id_merchant) as jumlah_order, sum(harga) as jumlah_pendapatan
from rakamin_order
group by id_merchant
order by jumlah_pendapatan desc

--soal 4
select metode_bayar, count(metode_bayar) as frekuensi
from rakamin_order
group by metode_bayar
having count(1)>10
order by frekuensi desc

--soal 5
select min(tmp.frekuensi) as pop_min, max(tmp.frekuensi) as pop_max 
from (
	select kota, count(kota) as frekuensi
	from rakamin_customer_address
	group by 1
) as tmp
  
--soal 6
select rm.nama_merchant, ro.metode_bayar, count(ro.metode_bayar) as frekuensi
from rakamin_order ro
join rakamin_merchant rm
	on ro.id_merchant = rm.id_merchant
group by 1,2
order by 1, 3 desc

--soal 7
with tmp as(
	select id_pelanggan, sum(kuantitas) as total_kuantitas
	from rakamin_order ro
	group by id_pelanggan
	having  sum(kuantitas) >5
)

select tmp.*, rc.nama, rc.email
from tmp
join rakamin_customer rc
	on tmp.id_pelanggan = rc.id_pelanggan
